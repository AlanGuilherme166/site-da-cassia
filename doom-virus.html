<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@900&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <title>Doom: Tiro em V√≠rus</title>
    <!-- Three.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
    <style>
        #round-overlay {
            position: fixed;
            left: 0; top: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.85);
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            font-size: 2.2rem;
        }
            #buff-overlay {
                position: fixed;
                left: 0; top: 0; width: 100vw; height: 100vh;
                background: rgba(0,0,0,0.92);
                color: #fff;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                z-index: 3000;
            }
            .buff-title {
                font-family: 'Creepster', cursive;
                color: #ffeb3b;
                font-size: 2.2rem;
                margin-bottom: 1.2rem;
                text-shadow: 2px 2px 8px #000, 0 0 16px #ffeb3b;
            }
            .buff-cards {
                display: flex;
                gap: 2rem;
            }
            .buff-card {
                background: #232323;
                border-radius: 18px;
                box-shadow: 0 0 16px #000;
                width: 140px;
                height: 180px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                border: 4px solid transparent;
                transition: border 0.2s, transform 0.2s;
                font-family: 'Roboto', sans-serif;
            }
            .buff-card:hover {
                border: 4px solid #ffeb3b;
                transform: scale(1.07);
            }
            .buff-emoji {
                font-size: 3.5rem;
                margin-bottom: 1rem;
            }
            .buff-name {
                font-size: 1.2rem;
                font-weight: bold;
                margin-bottom: 0.5rem;
            }
            .buff-desc {
                font-size: 1rem;
                color: #fffde7;
                text-align: center;
            }
        .scary-text {
            font-family: 'Creepster', cursive;
            color: #ff1744;
            font-size: 2.8rem;
            margin-bottom: 1.2rem;
            text-shadow: 2px 2px 8px #000, 0 0 16px #ff1744;
        }
        .curiosity-text {
            font-size: 1.3rem;
            color: #fffde7;
            margin-bottom: 2rem;
            max-width: 600px;
            text-align: center;
        }
        .start-btn {
            background: #ff1744;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            padding: 12px 32px;
            cursor: pointer;
            margin-top: 1.5rem;
            font-family: inherit;
            box-shadow: 0 0 10px #000;
        }
        body { background: #181818; color: #e0e0e0; font-family: Arial, sans-serif; text-align: center; }
    .sidebar { position: fixed; top: 0; left: 0; height: 100%; width: 60px; background-color: #121210; transition: width 0.3s; padding-top: 20px; z-index: 1001; overflow-x: hidden; overflow-y: hidden; }
        .sidebar:hover { width: 200px; }
        .sidebar ul { list-style: none; padding: 0; }
        .sidebar ul li { color: #e0e0e0; padding: 15px; text-align: center; transition: background-color 0.3s; opacity: 1; cursor: pointer; }
        .sidebar ul li:hover { background-color: #232323; }
        .sidebar ul li span { opacity: 0; transition: opacity 0.3s; white-space: nowrap; margin-left: 10px; }
        .sidebar:hover ul li span { opacity: 1; }
        #main-content { margin-left: 70px; padding: 20px; }
        #game-area { background: #232323; margin: 40px auto; width: 500px; height: 300px; border-radius: 10px; box-shadow: 0 0 10px #000; position: relative; overflow: hidden; }
        #player { position: absolute; left: 230px; bottom: 10px; font-size: 40px; }
        .virus { position: absolute; top: 0; font-size: 32px; }
        .bullet { position: absolute; width: 8px; height: 16px; background: #ffeb3b; border-radius: 4px; }
        #score { margin-top: 20px; }
    </style>
</head>
<body>
    <div id="round-overlay" style="display:none;">
        <div class="scary-text" id="scary-text"></div>
        <div class="curiosity-text" id="curiosity-text"></div>
        <button class="start-btn" id="start-round-btn">Come√ßar Round</button>
    </div>
        <div id="buff-overlay" style="display:none;">
            <div class="buff-title">Escolha uma carta de buff!</div>
            <div class="buff-cards" id="buff-cards"></div>
        </div>
    <div class="sidebar">
        <ul>
            <li onclick="window.location.href='dino-bio.html'">ü¶ñ<span>Quiz Biologia</span></li>
            <li onclick="window.location.href='dino-jumper.html'">ü¶†<span>Bact√©ria Jumper</span></li>
            <li onclick="window.location.href='campo-minado-virus.html'">ü¶†<span>Campo Minado V√≠rus</span></li>
            <li onclick="window.location.href='jogo-da-velha.html'">ü¶†ü¶†<span>Jogo da Velha Bio</span></li>
            <li onclick="window.location.href='jogo-tiro-bacteria.html'">üß´<span>Bact√©ria Atiradora</span></li>
            <li onclick="window.location.href='doom-virus.html'">üß™<span>Doom: Tiro em V√≠rus</span></li>
            <li onclick="window.location.href='index.html'">üè†<span>Voltar ao Site</span></li>
        </ul>
    </div>
    <div id="main-content">
        <h1>Doom: Defesa da Pessoa</h1>
        <div id="game-area" style="width: 100vw; height: 100vh; position: absolute; left: 0; top: 0; z-index: 0;"></div>
    </div>
    <script>
    // Curiosidades e textos assustadores
    const curiosities = [
        "Seu corpo abriga trilh√µes de bact√©rias, superando o n√∫mero de c√©lulas humanas!",
        "Alguns v√≠rus podem permanecer dormentes no corpo por anos antes de atacar.",
        "Bact√©rias podem trocar genes entre si, tornando-se mais resistentes.",
        "O v√≠rus da gripe pode sobreviver em superf√≠cies por at√© 48 horas.",
        "Existem bact√©rias que conseguem sobreviver em ambientes radioativos!"
    ];
        // Buffs dispon√≠veis
        const buffs = [
            {
                name: 'Companion',
                emoji: 'üß´',
                desc: 'Um companheiro atira junto com voc√™!',
                apply: function() { companionActive = true; }
            },
            {
                name: 'Velocidade de Tiro',
                emoji: '‚ö°',
                desc: 'Reduz o tempo de recarga entre tiros.',
                apply: function() { fireRate = Math.max(0.15, fireRate - 0.15); }
            },
            {
                name: 'Seringa Gigante',
                emoji: 'üíâ',
                desc: 'Seus tiros ficam maiores e mais fortes.',
                apply: function() { bulletScale = 1.7; }
            },
            {
                name: 'Vida Extra',
                emoji: '‚ù§Ô∏è',
                desc: 'Sobrevive a um ataque de v√≠rus.',
                apply: function() { extraLife = true; }
            },
            {
                name: 'Tiro Triplo',
                emoji: 'üî±',
                desc: 'Atira tr√™s seringas de uma vez.',
                apply: function() { tripleShot = true; }
            },
            // Novos buffs tem√°ticos
            {
                name: 'Recupera√ß√£o',
                emoji: 'ü©π',
                desc: 'Cura gradual de PV a cada round.',
                apply: function() { healingActive = true; }
            },
            {
                name: 'Resist√™ncia Elemental',
                emoji: '‚ùÑÔ∏è',
                desc: 'Absorve parte do dano elemental (fogo, gelo, eletricidade).',
                apply: function() { elementalResist = true; }
            },
            {
                name: 'Aumento de Dano',
                emoji: 'üí•',
                desc: 'Seus ataques causam mais dano.',
                apply: function() { damageBuff = true; }
            },
            {
                name: 'Melhoria de Defesa',
                emoji: 'üõ°Ô∏è',
                desc: 'Reduz o dano recebido dos inimigos.',
                apply: function() { defenseBuff = true; }
            },
            {
                name: 'Aura',
                emoji: 'üåÄ',
                desc: 'Recupera√ß√£o gradual de PV durante a wave.',
                apply: function() { auraActive = true; }
            },
            {
                name: 'Elemenfagia',
                emoji: '‚öóÔ∏è',
                desc: 'Absorve dano elemental e converte em PV.',
                apply: function() { elemenfagiaActive = true; }
            },
            {
                name: 'Guarda',
                emoji: 'üõ°Ô∏èü§ñ',
                desc: 'Ao morrer, invoca um aliado ou escudo.',
                apply: function() { guardaActive = true; }
            }
        ];

        // Vari√°veis dos novos buffs
        let healingActive = false;
        let elementalResist = false;
        let damageBuff = false;
        let defenseBuff = false;
        let auraActive = false;
        let elemenfagiaActive = false;
        let guardaActive = false;
        let fireRate = 0.5;
        let lastShot = 0;
        let bulletScale = 1;
        let companionActive = false;
        let extraLife = false;
        let tripleShot = false;

        // Exibir cartas de buff
        function showBuffOverlay() {
            const overlay = document.getElementById('buff-overlay');
            const cardsDiv = document.getElementById('buff-cards');
            cardsDiv.innerHTML = '';
            // Sorteia 3 buffs diferentes
            let options = buffs.slice().sort(() => 0.5 - Math.random()).slice(0,3);
            options.forEach(buff => {
                const card = document.createElement('div');
                card.className = 'buff-card';
                card.innerHTML = `<div class="buff-emoji">${buff.emoji}</div><div class="buff-name">${buff.name}</div><div class="buff-desc">${buff.desc}</div>`;
                card.onclick = () => {
                    buff.apply();
                    overlay.style.display = 'none';
                    setTimeout(() => { spawnWave(); }, 500);
                };
                cardsDiv.appendChild(card);
            });
            overlay.style.display = 'flex';
        }
    const scaryTexts = [
        "Eles est√£o vindo...",
        "Voc√™ sente o cheiro da muta√ß√£o?",
        "A pr√≥xima onda ser√° pior...",
        "O medo se espalha como um v√≠rus...",
        "Prepare-se para o desconhecido!"
    ];
    let roundInProgress = false;
    function showRoundOverlay() {
        const overlay = document.getElementById('round-overlay');
        const scary = document.getElementById('scary-text');
        const curiosity = document.getElementById('curiosity-text');
        scary.textContent = scaryTexts[Math.floor(Math.random()*scaryTexts.length)];
        curiosity.textContent = curiosities[Math.floor(Math.random()*curiosities.length)];
        overlay.style.display = 'flex';
        roundInProgress = false;
    }
    function hideRoundOverlay() {
        document.getElementById('round-overlay').style.display = 'none';
        roundInProgress = true;
    }
    document.getElementById('start-round-btn').onclick = hideRoundOverlay;
    // --- Sistema de tiro (seringas) ---
    let bullets = [];
    document.addEventListener('keydown', (e) => {
        if (e.code === 'Space') shoot();
    });

    let roundReady = false;
    function spawnWave() {
        // Limpa inimigos antigos
        for (let i = enemies.length - 1; i >= 0; i--) {
            scene.remove(enemies[i]);
            enemies.splice(i, 1);
        }
        // Aumenta dificuldade a cada wave
        enemiesToSpawn = 3 + Math.floor(currentWave * 1.2);
        for (let i = 0; i < enemiesToSpawn; i++) {
            let angle = Math.random() * Math.PI * 2;
            let radius = 13;
            let x = Math.cos(angle) * radius;
            let z = Math.sin(angle) * radius;
            let enemyGeo = new THREE.SphereGeometry(1, 32, 32);
            let enemyMat = new THREE.MeshPhongMaterial({ color: 0xc62828 });
            let enemy = new THREE.Mesh(enemyGeo, enemyMat);
            enemy.position.set(x, 1, z);
            scene.add(enemy);
            enemies.push(enemy);
        }
        enemiesAlive = enemiesToSpawn;
        currentWave++;
        roundInProgress = false;
        roundReady = false;
        setTimeout(() => { roundReady = true; roundInProgress = true; }, 400); // s√≥ come√ßa ap√≥s sprites aparecerem
    }
    showRoundOverlay();
    // ...existing code...
    // --- Three.js setup ---
    let scene = new THREE.Scene();
    let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    let renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.getElementById('game-area').appendChild(renderer.domElement);

    // Arena (ch√£o)
    let floorGeometry = new THREE.PlaneGeometry(30, 30);
    let floorMaterial = new THREE.MeshPhongMaterial({ color: 0x222222 });
    let floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2;
    scene.add(floor);

    // Luz
    let light = new THREE.PointLight(0xffffff, 1, 100);
    light.position.set(0, 20, 10);
    scene.add(light);

    // Player (bact√©ria)
    let bacteriaGeometry = new THREE.SphereGeometry(1, 32, 32);
    let bacteriaMaterial = new THREE.MeshPhongMaterial({ color: 0x00c853 });
    let bacteria = new THREE.Mesh(bacteriaGeometry, bacteriaMaterial);
    bacteria.position.set(0, 1, 10);
    scene.add(bacteria);

    // Pessoa defendida
    let personGeometry = new THREE.SphereGeometry(1.2, 32, 32);
    let personMaterial = new THREE.MeshPhongMaterial({ color: 0xffe082 });
    let person = new THREE.Mesh(personGeometry, personMaterial);
    person.position.set(0, 1.2, -10);
    scene.add(person);

    // Inimigos (v√≠rus vermelhos)
    // Removido bloco duplicado. Usar apenas a vers√£o moderna de spawnWave e vari√°veis j√° declaradas acima.

    // Camera
    camera.position.set(0, 5, 18);
    camera.lookAt(bacteria.position);

    // Movimenta√ß√£o b√°sica (WASD)
    let move = { left: false, right: false, up: false, down: false };
    document.addEventListener('keydown', (e) => {
        if (e.code === 'KeyA') move.left = true;
        if (e.code === 'KeyD') move.right = true;
        if (e.code === 'KeyW') move.up = true;
        if (e.code === 'KeyS') move.down = true;
    });
    document.addEventListener('keyup', (e) => {
        if (e.code === 'KeyA') move.left = false;
        if (e.code === 'KeyD') move.right = false;
        if (e.code === 'KeyW') move.up = false;
        if (e.code === 'KeyS') move.down = false;
    });

    function animate() {
        // Atualiza balas (seringas)
        for (let i = bullets.length - 1; i >= 0; i--) {
            let b = bullets[i];
            b.mesh.position.addScaledVector(b.dir, 0.7);
            // Remove se sair da arena
            if (Math.abs(b.mesh.position.x) > 16 || Math.abs(b.mesh.position.z) > 16) {
                scene.remove(b.mesh);
                bullets.splice(i, 1);
                continue;
            }
            // Colis√£o com inimigos
            for (let j = enemies.length - 1; j >= 0; j--) {
                let enemy = enemies[j];
                if (b.mesh.position.distanceTo(enemy.position) < 1.2) {
                    scene.remove(enemy);
                    enemies.splice(j, 1);
                    scene.remove(b.mesh);
                    bullets.splice(i, 1);
                    break;
                }
            }
        }
        // Movimenta√ß√£o do player
        let speed = 0.2;
        if (move.left) bacteria.position.x -= speed;
        if (move.right) bacteria.position.x += speed;
        if (move.up) bacteria.position.z -= speed;
        if (move.down) bacteria.position.z += speed;
        // Limites da arena
        bacteria.position.x = Math.max(-14, Math.min(14, bacteria.position.x));
        bacteria.position.z = Math.max(-14, Math.min(14, bacteria.position.z));
        camera.lookAt(bacteria.position);

        // Movimento dos inimigos em dire√ß√£o √† pessoa s√≥ se roundReady
        if (roundReady) {
            let enemySpeed = 0.04 + wave * 0.01;
            for (let i = enemies.length - 1; i >= 0; i--) {
                let enemy = enemies[i];
                let dir = new THREE.Vector3();
                dir.subVectors(person.position, enemy.position).normalize();
                enemy.position.x += dir.x * enemySpeed;
                enemy.position.z += dir.z * enemySpeed;
                // Checa se chegou na pessoa
                let dist = enemy.position.distanceTo(person.position);
                if (dist < 2) {
                    // Game over (pode melhorar depois)
                    alert('Game Over! O v√≠rus alcan√ßou a pessoa!');
                    window.location.reload();
                    return;
                }
            }
        }

        renderer.render(scene, camera);
        requestAnimationFrame(animate);
    }
    animate();
    </script>
</body>
</html>
